写点AngularJS的东西吧

Angular这个东西，最近很火热，我来谈点不好的地方吧。

我始终认为，all in one的框架很难做，为什么backbone功能弱那么多，也可以很流行，是因为它轻量、灵活，它不把所有事情全部自己搞，可以搭配underscore做底层操作，可以搭配jQuery做界面操作。

Angular确实很强大，


基于AngularJS构建单页应用

单页应用

大型单页应用要做的第一件事就是分层架构。

分层架构有利于把职责清晰化，每块可以单独做测试。

数据模型层必须独立出来，所以有些Angular文章推荐给所有service建一个module，然后把一切包含数据模型的service都放进去。可以这么做，也可以再细分。

分层做完，就要考虑懒加载的问题了。

我们看看一个典型的场景，一个工作台，或者说门户界面，上面能够放很多小部件，类似iGoogle那样，用户可以任意加已有的部件，这些部件都是基于某种约定，由第三方开发人员完成。这种如果在单页应用里，该怎么实现呢？

先来看部件有些什么可以做的事。他可以有界面，有逻辑，有样式。这些都可以分别动态加载出来，比如HTML片段可以ng-include或者$get过来append，js文件可以require，css可以行间也可以动态加rule，因为这些部件是要跟我们主界面在同一个页面作用域内，所以要尽量营造隔离的环境。

HTML好办，它直接拿来放在某容器里就可以了，互相影响不到。JavaScript的话，最基本的就是避免全局变量，在Angular体系中，还需要作些特殊的考虑。我们知道，Angular里面，第一级组织单元是module，但它这个module的概念跟AMD那种module的不同，如果说AMD的module相当于Java Class的级别，Angular的要相当于package了。

这就有了我们的第一个问题：部件里面的JavaScript代码跟主界面的在不在一个module内？如果是别的框架，这不是个问题，但这货是angular，有些纠结，这里面还分两种情况：

- 部件很独立，相互无任何协作关系
- 部件之间有协作，包括可能共享代码或者有通信

第一种很好办，我们可以让这个部件自己定义ng-app，这样它就是一个独立隔离的环境了。
